//>>built
define("gridx/core/model/_Cache",["dojo/_base/declare","./_Extension"],function(_1,_2){return _1(_2,{constructor:function(_3,_4){_4=_4||{};this.store=_4.store;this.columns=_4.columns;var _5=this.store.fetch;if(!_5&&this.store.notify){this.connect(this.store,"notify",function(_6,id){if(_6===undefined){this._onDelete(id);}else{if(id===undefined){this._onNew(_6);}else{this._onSet(_6);}}});}else{this.connect(this.store,_5?"onSet":"put","_onSet");this.connect(this.store,_5?"onNew":"add","_onNew");this.connect(this.store,_5?"onDelete":"remove","_onDelete");}this.clear();this._mixinAPI("byIndex","byId","indexToId","idToIndex","size","treePath","hasChildren","keep","free","item");},destroy:function(){this.inherited(arguments);this.clear();},onBeforeFetch:function(){},onAfterFetch:function(){},onSet:function(id,_7,_8){},onNew:function(id,_9,_a){},onDelete:function(id,_b){},onSizeChange:function(_c,_d){},keep:function(){},free:function(){},treePath:function(id){return this.byId(id)?[""]:[];},hasChildren:function(id){return false;},_itemToObject:function(_e){var s=this.store;if(s.fetch){var i,_f,obj={},_10=s.getAttributes(_e);for(i=0,_f=_10.length;i<_f;++i){obj[_10[i]]=s.getValue(_e,_10[i]);}return obj;}return _e;},_formatCell:function(_11,_12){var col=this.columns[_11];return col.formatter?col.formatter(_12):_12[col.field||_11];},_formatRow:function(_13){if(!this.columns){return _13;}var res={},_14;for(_14 in this.columns){res[_14]=this._formatCell(_14,_13);}return res;},onAddColumn:function(col){var id,c;for(id in this._cache){c=this._cache[id];c.data[col.id]=this._formatCell(col.id,c.rawData);}},onRemoveColumn:function(col){var id;for(id in this._cache){delete this._cache[id][col.id];}},onSetColumns:function(_15){this.columns=_15;var id,c,_16,col;for(id in this._cache){c=this._cache[id];for(_16 in this.columns){col=this.columns[_16];c.data[_16]=this._formatCell(col.id,c.rawData);}}}});});