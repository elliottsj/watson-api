//>>built
define("gridx/modules/Menu",["dojo/_base/declare","../core/_Module","dojo/_base/html","dojo/keys","dojo/_base/event","dojo/_base/lang","dijit/registry","dijit/Menu"],function(_1,_2,_3,_4,_5,_6,_7,_8){return _2.registerModule(_1("gridx.modules.Menu",_2,{name:"menu",getAPIPath:function(){return {menu:this};},constructor:function(){this._menus={};},context:null,bind:function(_9,_a){var t=_a.hookPoint.toLowerCase(),_b=_a.selected?t+"-selected":t,_c=this._evtMap[t],m=this._menus[_b]=this._menus[_b]||{},_d=_6.partial(this._showMenu,_b);this.disconnect(m.open);this.disconnect(m.close);m.menu=_7.byId(_9);if(_c){m.open=this.connect(this.grid,_c,_d);}else{if(t=="body"){m.open=this.connect(this.grid.bodyNode,"oncontextmenu",_d);}else{m.open=this.connect(this.grid.domNode,"oncontextmenu",_d);}}m.close=this.connect(m.menu,"onClose",function(){this._mutex=0;});},unbind:function(_e){var _f,_10=this._menus;_e=_7.byId(_e);for(_f in _10){if(_10[_f].menu==_e){this.disconnect(_10[_f].open);this.disconnect(_10[_f].close);delete _10[_f];return;}}},_evtMap:{header:"onHeaderContextMenu",headercell:"onHeaderCellContextMenu",cell:"onCellContextMenu",row:"onRowContextMenu"},_showMenu:function(_11,e){if(!this._mutex&&this._menus[_11].menu){var g=this.grid,_12=!_11.indexOf("row"),_13=!_11.indexOf("cell"),_14=!_11.indexOf("headercell"),_15=_11.indexOf("-")>0,_16=!!((_13&&_3.hasClass(e.cellNode,"dojoxGridxCellSelected"))||(_14&&_3.hasClass(g.header.getHeaderNode(e.columnId),"dojoxGridxColumnSelected"))||(_12&&_3.hasClass(g.body.getRowNode({rowId:e.rowId}),"dojoxGridxRowSelected")));if(_15==_16||(!_15&&_16&&!this._menus[_11+"-selected"])){this.context={grid:g,column:_14?g.column(e.columnId,true):undefined,row:_12?g.row(e.rowId,true):undefined,cell:_13?g.cell(e.rowId,e.columnId,true):undefined};_5.stop(e);this._mutex=1;this._menus[_11].menu._openMyself({target:e.target,coords:e.keyCode!=_4.F10&&"pageX" in e?{x:e.pageX,y:e.pageY}:null});}}}}));});