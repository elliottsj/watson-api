//>>built
require({cache:{"url:gridx/templates/FilterDialog.html":"<label>Match </label>\n<select dojoType=\"dijit.form.Select\">\n\t<option value=\"all\">All rules</option>\n\t<option value=\"any\">Any rules</option>\n</select>\n\n<div class=\"dojoxGridxFilterAccordionWrapper\">\n\t<div dojoType=\"dijit.layout.AccordionContainer\"></div>\n</div>\n\n<div class=\"dojoxGridxFilterDialogButtons\">\n\t<input type=\"button\" class=\"dojoxGridxFilterDialogBtnAdd\" dojoType=\"dijit.form.Button\" showLabel=\"false\" iconClass=\"dojoxGridxFilterBtnAddRule\"/>\n\t<input type=\"button\" dojoType=\"dijit.form.Button\" label=\"Filter\"/>\n\t<input type=\"button\" dojoType=\"dijit.form.Button\" label=\"Clear\"/>\n\t<input type=\"button\" dojoType=\"dijit.form.Button\" label=\"Cancel\"/>\n</div>"}});define("gridx/modules/filter/FilterDialog",["dojo/_base/kernel","dijit","dojo/text!../../templates/FilterDialog.html","dijit/Dialog","dijit/layout/AccordionContainer","dojo/data/ItemFileReadStore","./FilterPane","./Filter","dojo/_base/declare","dojo/_base/array","dojo/_base/html","dojo/query"],function(_1,_2,_3){return _1.declare("gridx.modules.filter.FilterDialog",_2.Dialog,{title:"Filter",cssClass:"dojoxGridxFilterDialog",grid:null,autofocus:false,postCreate:function(){this.inherited(arguments);this.set("content",_3);this._initWidgets();_1.addClass(this.domNode,"dojoxGridxFilterDialog");},done:function(){this.hide();this.grid.filterBar.applyFilter(this.getData());},getData:function(){return {type:this._sltMatch.get("value"),conditions:_1.map(this._accordionContainer.getChildren(),function(p){return p.getData();})};},setData:function(_4){this.removeChildren();if(!_4||!_4.conditions.length){return;}this._sltMatch.set("value","all"&&_4&&_4.type);_1.forEach(_4.conditions,function(d){this.addRule().setData(d);},this);},removeChildren:function(){_1.forEach(this._accordionContainer.getChildren(),_1.hitch(this._accordionContainer,"removeChild"));},clear:function(){this.grid.filterBar.confirmToExecute(function(){this.grid.filterBar.clearFilter(true);this.hide();},this);},cancel:function(){this.hide();},show:function(){this.inherited(arguments);if(!this._accordionContainer.hasChildren()){this.addRule();}},addRule:function(){var ac=this._accordionContainer;if(ac.getChildren().length===3){ac._contentBox.w-=dojox.html.metrics.getScrollbar().w;}var fp=new gridx.modules.filter.FilterPane({grid:this.grid,title:"Rule"});ac.addChild(fp);ac.selectChild(fp);if(!this._titlePaneHeight){this._titlePaneHeight=_1.position(fp._buttonWidget.domNode).h+3;}fp._initCloseButton();fp._onColumnChange();try{fp.tbSingle.focus();}catch(e){}_1.toggleClass(ac.domNode,"dojoxGridxFilterSingleRule",ac.getChildren().length===1);this.connect(fp,"onChange","_updateButtons");this._updateButtons();this._updateAccordionContainerHeight();ac.domNode.parentNode.scrollTop=100000;return fp;},_initWidgets:function(){this._accordionContainer=_2.byNode(_1.query(".dijitAccordionContainer",this.domNode)[0]);this._sltMatch=_2.byNode(_1.query(".dijitSelect",this.domNode)[0]);var _5=_1.query(".dijitButton",this.domNode);this._btnAdd=_2.byNode(_5[0]);this._btnFilter=_2.byNode(_5[1]);this._btnClear=_2.byNode(_5[2]);this._btnCancel=_2.byNode(_5[3]);this.connect(this._btnAdd,"onClick","addRule");this.connect(this._btnFilter,"onClick","done");this.connect(this._btnClear,"onClick","clear");this.connect(this._btnCancel,"onClick","cancel");this.connect(this._accordionContainer,"removeChild","_updateButtons");this.connect(this._accordionContainer,"removeChild","_updatePaneTitle");},_updatePaneTitle:function(){_1.forEach(this._accordionContainer.getChildren(),function(_6){_6._updateTitle();});},_updateButtons:function(){var _7=this._accordionContainer.getChildren();if(_1.some(_7,function(c){return c.getData()===null;})){this._btnFilter.set("disabled",true);}else{this._btnFilter.set("disabled",false);}var c=this.grid.filterBar.maxRuleCount;this._btnAdd.set("disabled",_7.length>=c&&c>0);this._btnClear.set("disabled",!this.grid.filterBar.filterData);},_updateAccordionContainerHeight:function(){var ac=this._accordionContainer,_8=ac.getChildren().length;_1.style(ac.domNode,"height",145+_8*this._titlePaneHeight+"px");ac.resize();}});});