//>>built
define("gridx/modules/select/Cell",["dojo/_base/declare","dojo/_base/array","dojo/_base/html","dojo/_base/sniff","dojo/keys","./_RowCellBase","../../core/_Module"],function(_1,_2,_3,_4,_5,_6,_7){return _7.registerModule(_1("gridx.modules.select.Cell",_6,{name:"selectCell",cellMixin:{select:function(){this.grid.select.cell.selectById(this.row.id,this.column.id);return this;},deselect:function(){this.grid.select.cell.deselectById(this.row.id,this.column.is);return this;},isSelected:function(){return this.model.isMarked(this.row.id,this.column.id);}},getSelected:function(){var _8=[];_2.forEach(this.grid._columns,function(_9){var _a=this.model.getMarkedIds(this._getMarkType(_9.id));_8.push.apply(_8,_2.map(_a,function(_b){return [_b,_9.id];}));},this);return _8;},clear:function(){if(this.arg("enabled")){_2.forEach(this.grid._columns,function(_c){var _d=this._getMarkType(_c.id),_e=this.model.getMarkedIds(_d),_f=_e.length,i;for(i=0;i<_f;++i){this.model.markById(_e[i],false,_d);}},this);}},_type:"cell",_markTypePrefix:"select_",_getMarkType:function(_10){var _11=this._markTypePrefix+_10;this.model._spTypes[_11]=1;return _11;},_init:function(){this.inherited(arguments);this.batchConnect([this.grid,"onCellMouseDown",function(e){this._select([e.rowId,e.columnId],e.ctrlKey);}],[this.grid,_4.isFF<4?"onCellKeyUp":"onCellKeyDown",function(e){if(e.keyCode===_5.SPACE){this._select([e.rowId,e.columnId],e.ctrlKey);}}]);},_onMark:function(_12,_13,_14){if(_14.indexOf(this._markTypePrefix)===0){var _15=_14.substr(this._markTypePrefix.length);if(this.grid._columnsById[_15]){this._highlight(_13,_15,_12);this.model.when({id:_13},function(){this[_12?"onSelected":"onDeselected"](this.grid.cell(_13,_15,true));},this);}}},_highlight:function(_16,_17,_18){var _19=this.grid.body.getCellNode({rowId:_16,colId:_17});if(_19){_3[_18?"addClass":"removeClass"](_19,"dojoxGridxCellSelected");this.onHighlightChange();}},_markById:function(_1a,_1b){this.model.markById(_1a[0],_1b,this._getMarkType(_1a[1]));},_onRender:function(_1c,_1d){var _1e=this.model,end=_1c+_1d,i,j,_1f,_20,_21=this.grid._columns;for(i=_1c;i<end;++i){_1f=_1e.indexToId(i);for(j=_21.length-1;j>=0;--j){_20=_21[j].id;if(_1e.isMarked(_1f,this._getMarkType(_20))){this._highlight(_1f,_20,true);}}}}}));});