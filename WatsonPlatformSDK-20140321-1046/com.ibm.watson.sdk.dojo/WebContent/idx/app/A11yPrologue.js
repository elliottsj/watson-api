//>>built
require({cache:{"url:idx/app/templates/A11yPrologue.html":"<div class=\"${baseClass}\" role=\"region\" aria-label=\"${_resources.a11yPrologueLabel}\">\r\n<p data-dojo-attach-point=\"shortcutListMsgNode\"></p>\r\n<ul data-dojo-attach-point=\"shortcutListNode\">\r\n<li data-dojo-attach-point=\"_prologueShortcut\"></li>\r\n</ul>\r\n</div>"}});define("idx/app/A11yPrologue",["dojo/_base/declare","dijit/_Widget","dijit/_TemplatedMixin","dojo/_base/lang","dojo/aspect","dojo/on","dojo/string","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_base/manager","dijit/focus","dijit/a11y","dijit/layout/StackContainer","../string","../util","../resources","dojo/text!./templates/A11yPrologue.html","dojo/i18n!../nls/base","dojo/i18n!./nls/base","dojo/i18n!./nls/A11yPrologue"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13){return _1("idx.app.A11yPrologue",[_2,_3],{prologueAccessKey:"0",a11yStatementURL:"",a11yStatementAccessKey:"1",mainNode:"",mainAccessKey:"2",navigationNode:"",navigationAccessKey:"3",bannerNode:"",bannerAccessKey:"4",externalLinksInOwnWindow:true,baseClass:"idxA11yPrologue",templateString:_13,resources:null,constructor:function(_14,_15){this.domNode=_15;this.ctorArgs=_14;this._nextNodeID=0;this._nextShortcutID=0;this._mainNode=null;this._navigationNode=null;this._bannerNode=null;this._linkHandles={};this._shortcutHandles={};this._shortcutsByID={};this._shortcuts=[];this._magicNumber=Math.floor(Math.random()*1000000);},destroy:function(){for(var _16 in this._linkHandles){var _17=this._linkHandles[_16];if(_17){_17.remove();}delete this._linkHandles[_16];}for(var _18 in this._shortcutHandles){var _17=this._shortcutHandles[_18];if(_17){_17.remove();}delete this._shortcutHandles[_18];}this.inherited(arguments);},postMixInProperties:function(){this.inherited(arguments);if(!this._rawResources){this._rawResources=null;this._resetResources();}},_getKeySequenceMessage:function(_19){if(!_19){return null;}var _1a="${accessKey}";if(_11.isIE){_1a=this._resources.keySequence_InternetExplorer;}else{if(_11.isFF){_1a=this._resources.keySequence_Firefox;}else{if(_11.isSafari){_1a=this._resources.keySequence_Safari;}else{if(_11.isChrome){_1a=this._resources.keySequence_Chrome;}}}}var _1b=_7.substitute(_1a,{accessKey:_19.toUpperCase()});return _1b;},_setResourcesAttr:function(_1c){this.resources=_1c;this._resetResources();},_getResourcesAttr:function(){return this._resources;},_resetResources:function(){var _1d=_12.getResources("idx/app/A11yPrologue",this.lang);if(this.resources){var _1e=new Object();_4.mixin(_1e,_1d);_4.mixin(_1e,this.resources);this._resources=_1e;}else{this._resources=_1d;}if(this._started){this._reformat();}},_reformat:function(){if(this.shortcutListMsgNode){this.shortcutListMsgNode.innerHTML=this._resources.shortcutListMessage;}this._setupLinks();this._setupShortcuts();},startup:function(){if(this._started){return;}this.inherited(arguments);this._started=true;var _1f=_a.get(this.domNode,"id");if(!_10.nullTrim(_1f)){_a.set(this.domNode,"id",this.id);}this._resetResources();},addShortcut:function(_20,_21,_22){var _23=_11.typeOfObject(_20);var _24=null;if(_23=="string"){_24=_9.byId(_20);if(_24){_20=_24;}}else{_24=_20;}if((_24)&&(!_22)){_22=this._getExistingAccessKey(_24);}var _25=this.id+"_shortcut_"+this._nextShortcutID++;var _26={shortcutID:_25,target:_20,accessKey:_22,description:_21};this._shortcuts.push(_26);this._shortcutsByID[_25]=_26;_26.itemNode=this._setupShortcut(_26.target,_26.accessKey,_26.description,null,this._prologueShortcut,"before",_26.shortcutID);return _25;},removeShortcut:function(_27){var _28=this._shortcutsByID[_27];if(!_28){return;}var _29=-1;for(var _2a=0;_2a<this._shortcuts.length;_2a++){var _2b=this._shortcuts[_2a];if(_2b.shortcutID==_27){_29=_2a;break;}}if(_29>=0){this._shortcuts.splice(_29,1);}this._shortcutsByID[_27]=null;var _2c=this._shortcutHandles[_27];if(_2c){_2c.remove();delete this._shortcutHandles[_27];_2c=null;}_2b.itemNode=this._setupShortcut(null,_2b.accessKey,_2b.description,_2b.itemNode,this._prologueShortcut,"before",_2b.shortcutID);},_setA11yStatementURLAttr:function(url){this.a11yStatementURL=url;this._setupStatementShortcut();},_setA11yStatementAccessKeyAttr:function(key){this.a11yStatementAccessKey=key;this._setupStatementShortcut();},_setMainAccessKeyAttr:function(key){this.mainAccessKey=key;this._setupMainLink();this._setupMainShortcut();},_setNavigationAccessKeyAttr:function(key){this.navigationAccessKey=key;this._setupNavigationLink();this._setupNavigationShortcut();},_setBannerAccessKeyAttr:function(key){this.bannerAccessKey=key;this._setupBannerLink();this._setupBannerShortcut();},_generateNodeID:function(){var _2d=Math.floor(Math.random()*1000000001);return this.id+"_id_"+_2d+"_"+(this._nextNodeID++);},_resolveNode:function(_2e){var _2f=null;var _30=null;var _31=_11.typeOfObject(_2e);if(_31=="string"){_30=_2e;if(!_10.nullTrim(_30)){return null;}_2f=_9.byId(_30);if(!_2f){throw new Error("Could not find node for ID: "+_30);}}else{_2f=_2e;_30=_2f.id;if(!_10.nullTrim(_30)){_30=this._generateNodeID();_a.set(_2f,"id",_30);}}var _32={node:_2f,nodeID:_30};if(_2f){var _33=_c.getEnclosingWidget(_2f);if(_33&&(_33.domNode==_2f)){_32.widget=_33;}}return _32;},_focusNode:function(_34,_35){if(!_34){return true;}var _36=null;if(_34 instanceof _2){_36=_34.domNode;if(_36){_34=_36.id;}}else{if(_11.typeOfObject(_34)!="string"){_36=_34;_34=_36.id;}else{_36=_9.byId(_34);if(!_36){var _37=_c.byId(_34);if(_37){_36=_37.domNode;if(_36){_34=_36.id;}}}}}if(!_36){return true;}_d.focus(_36);var _38=(!_e.isTabNavigable(_36));if(!_38&&_35){_8.stop(_35);}return _38;},_focusWidget:function(_39,_3a){if(!_39){return true;}var _3b=null;if(_39 instanceof _2){_3b=_39;_39=_3b.get("id");}else{if(_11.typeOfObject(_39)=="string"){_3b=_c.byId(_39);}if(!_3b){var _3c=_39;if(_11.typeOfObject(_39)=="string"){_3c=_9.byId(_39);if(_3a){_8.stop(_3a);}if(!_3c){return false;}}_3b=_c.getEnclosingWidget(_3c);if((!_3b)||(_3b.domNode!=_3c)){var _3d=this._focusNode(_39);if(!_3d&&_3a){_8.stop(_3a);}return _3d;}}_39=_3b.get("id");}if(_3b instanceof _f){var _3e=_3b.get("selectedChildWidget");if((_3e)&&(_3e.domNode)){var _3d=this._focusWidget(_3e.domNode);if(!_3d&&_3a){_8.stop(_3a);}return _3d;}}if(!_3b.isFocusable()){var _3d=this._focusNode(_3b.domNode);if(!_3d&&_3a){_8.stop(_3a);}return _3d;}if(_3b.focus){_3b.focus();if(_3a){_8.stop(_3a);}return false;}if(_3b.focusNode){this._focusNode(_3b.focusNode);if(_3a){_8.stop(_3a);}return false;}this._focusNode(_3b.domNode);if(_3a){_8.stop(_3a);}return false;},_setMainNodeAttr:function(_3f){var _40=this._resolveNode(_3f);if(_40){this._mainNode=_40.node;this.mainNode=_3f;var _41=_a.get(this._mainNode,"accessKey");if(_10.nullTrim(_41)){this.set("mainAccessKey",_10.nullTrim(_41));}}else{this.mainNode=_3f;this._mainNode=null;}this._setupMainLink();this._setupMainShortcut();},_setNavigationNodeAttr:function(_42){var _43=this._resolveNode(_42);if(_43){this._navigationNode=_43.node;this.navigationNode=_42;var _44=_a.get(this._navigationNode,"accessKey");if(_10.nullTrim(_44)){this.set("navigationAccessKey",_10.nullTrim(_44));}}else{this.navigationNode=_42;this._navigationNode=null;}this._setupNavigationLink();this._setupNavigationShortcut();},_setBannerNodeAttr:function(_45){var _46=this._resolveNode(_45);if(_46){this._bannerNode=_46.node;this.bannerNode=_45;var _47=_a.get(this._bannerNode,"accessKey");if(_10.nullTrim(_47)){this.set("bannerAccessKey",_10.nullTrim(_47));}}else{this.bannerNode=_45;this._bannerNode=null;}this._setupBannerLink();this._setupBannerShortcut();},_setupLinks:function(){this._setupMainLink();this._setupNavigationLink();this._setupBannerLink();},_setupShortcuts:function(){this._setupPrologueShortcut();this._setupStatementShortcut();this._setupMainShortcut();this._setupNavigationShortcut();this._setupBannerShortcut();for(var _48=0;_48<this._shortcuts;_48++){var _49=this._shortcuts[_48];this._setupShortcut(_49.target,_49.accessKey,_49.description,_49.itemNode,this._prologueShortcut,"before",_49.shortcutID);}},_getExistingAccessKey:function(_4a){var _4b=_a.get(_4a,"accessKey");if(_10.nullTrim(_4b)){return _4b;}var _4c=_c.getEnclosingWidget(_4a);if(!_4c){return null;}if(_4c.domNode!=_4a){return null;}if(!_4c.focusNode){return null;}_4b=_a.get(_4c.focusNode,"accessKey");return _4b;},_setupLink:function(_4d,_4e,_4f,_50,_51,_52,pos){if(!this._started){return;}if(_4e){var _53=this._resolveNode(_4e);if(!_51){_51=_b.create("DIV");_b.place(_51,_52,pos);}var _54=_53.nodeID;var _55="";var _56=this._getExistingAccessKey(_4e);if(_10.nullTrim(_4f)&&(_4f!=_10.nullTrim(_56))){_55=" accessKey='"+_4f+"'";}var _57=null;if(_53.widget){_57=_4.hitch(this,"_focusWidget",_54);}else{_57=_4.hitch(this,"_focusNode",_54);}var _58=this._generateNodeID();var _59=_7.substitute("<a id='${nodeID}' href='#${location}' ${accessKeyAttr}>"+this._resources.skipToLocationMessage+"</a>",{nodeID:_58,location:_54,accessKeyAttr:_55,description:_50});_51.innerHTML=_59;var _5a=_9.byId(_58);var _5b=this._linkHandles[_4d];if(_5b){_5b.remove();delete this._linkHandles[_4d];_5b=null;}if(_5a){_5b=_6(_5a,"click",_57);this._linkHandles[_4d]=_5b;}}else{var _5b=this._linkHandles[_4d];if(_5b){_5b.remove();delete this._linkHandles[_4d];_5b=null;}if(_51){_b.destroy(_51);_51=null;}}return _51;},_setupShortcut:function(_5c,_5d,_5e,_5f,_60,pos,_61){if(!this._started){return;}if(_5c){if(!_5f){_5f=_b.create("LI");_b.place(_5f,_60,pos);}var _62=_11.typeOfObject(_5c);var _63=(_62=="string")?"external":"internal";var _64=((_5c!=null)&&((_5c==this._mainNode)||(_5c==this._navigationNode)||(_5c==this._bannerNode)));var _65=((_10.nullTrim(_5d))?"Key":"");var _66="shortcut"+_65+"Message_"+_63;var _67=this._resources[_66];if(_65){if(_63=="external"){_67=_67.replace("${description}","<a href='${location}' ${accessKeyAttr} ${targetWindowAttr}>${description}</a>");}else{_67=_67.replace("${description}","<a id='${nodeID}' href='#${location}' ${accessKeyAttr}>${description}</a>");}}else{if(_63=="external"){_67="<a href='${location}' ${targetWindowAttr}>"+_67+"</a>";}else{_67="<a id='${nodeID}' href='#${location}'>"+_67+"</a>";}}var _68=this._getKeySequenceMessage(_5d);var _69=_5c;var _6a=null;var _6b="";if(_62!="string"){var _6c=this._resolveNode(_5c);_69=_6c.nodeID;if(_6c.widget){_6a=_4.hitch(this,"_focusWidget",_69);}else{_6a=_4.hitch(this,"_focusNode",_69);}}else{var _6d="_blank";if(_61){_6d=_61+"_"+this._magicNumber;}_6b="target='"+_6d+"'";}var _6e="";if(_10.nullTrim(_5d)){if(_62=="string"){if(_10.nullTrim(_5d)){_6e=" accessKey='"+_5d+"'";}}else{var _6f=this._getExistingAccessKey(_5c);if((!_64)&&(_5d!=_10.nullTrim(_6f))){_6e=" accessKey='"+_5d+"'";}}}var _70=this._generateNodeID();var _71=_7.substitute(_67,{nodeID:_70,keySequence:_68,location:_69,accessKeyAttr:_6e,targetWindowAttr:_6b,description:_5e});_5f.innerHTML=_71;var _72=_9.byId(_70);var _73=this._shortcutHandles[_61];if(_73){_73.remove();delete this._shortcutHandles[_61];_73=null;}if((_72)&&(_6a)){_73=_6(_72,"click",_6a);this._shortcutHandles[_61]=_73;}}else{var _73=this._shortcutHandles[_61];if(_73){_73.remove();delete this._shortcutHandles[_61];_73=null;}if(_5f){_b.destroy(_5f);_5f=null;}}return _5f;},_setupPrologueShortcut:function(){if(!this._started){return;}this._prologueShortcut=this._setupShortcut(this.domNode,this.prologueAccessKey,this._resources.a11yPrologueLabel,this._prologueShortcut,this.shortcutListNode,"last",this.id+"_prologue");},_setupStatementShortcut:function(){if(!this._started){return;}this._stmtShortcut=this._setupShortcut(this.a11yStatementURL,this.a11yStatementAccessKey,this._resources.a11yStatementLabel,this._stmtShortcut,this.shortcutListNode,"first",this.id+"_a11yStatement");},_setupMainLink:function(){if(!this._started){return;}this._mainLink=this._setupLink("main",this._mainNode,this.mainAccessKey,this._resources.a11yMainContentAreaName,this._mainLink,this.domNode,"first");},_setupMainShortcut:function(){if(!this._started){return;}var _74=this._stmtShortcut;var pos="after";if(!_74){_74=this.shortcutListNode;pos="first";}this._mainShortcut=this._setupShortcut(this._mainNode,this.mainAccessKey,this._resources.a11yMainContentAreaName,this._mainShortcut,_74,pos,this.id+"_main");},_setupNavigationLink:function(){if(!this._started){return;}var _75=this._mainLink;var pos="after";if(!_75){_75=this.domNode;pos="first";}this._navigationLink=this._setupLink("navigation",this._navigationNode,this.navigationAccessKey,this._resources.a11yNavigationAreaName,this._navigationLink,_75,pos);},_setupNavigationShortcut:function(){if(!this._started){return;}var _76=this._mainShortcut;var pos="after";if(!_76){_76=this._stmtShortcut;}if(!_76){_76=this.shortcutListNode;pos="first";}this._navigationShortcut=this._setupShortcut(this._navigationNode,this.navigationAccessKey,this._resources.a11yNavigationAreaName,this._navigationShortcut,_76,pos,this.id+"_nav");},_setupBannerLink:function(){if(!this._started){return;}this._bannerLink=this._setupLink("banner",this._bannerNode,this.bannerAccessKey,this._resources.a11yBannerAreaName,this._bannerLink,this.shortcutListMsgNode,"before");},_setupBannerShortcut:function(){if(!this._started){return;}var _77=this._navigationShortcut;var pos="after";if(!_77){_77=this._mainShortcut;}if(!_77){_77=this._stmtShortcut;}if(!_77){_77=this.shortcutListNode;pos="first";}this._bannerShortcut=this._setupShortcut(this._bannerNode,this.bannerAccessKey,this._resources.a11yBannerAreaName,this._bannerShortcut,_77,pos,this.id+"_banner");}});});