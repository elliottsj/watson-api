//>>built
require({cache:{"url:idx/form/templates/CheckBoxSelect.html":"<div id=\"widget_${id}\" class=\"dijitReset dijitInline idxComposite\" \r\n\t><div class=\"idxLabel dijitInline dijitHidden\" dojoAttachPoint=\"labelWrap\"><span class=\"idxRequiredIcon\">*&nbsp</span><label id=\"${id}_label\" for=\"${id}\" dojoAttachPoint=\"compLabelNode\"></label></div\r\n\t><table class=\"dijit dijitReset dijitInline dijitLeft\" aria-multiselectable=\"true\"\r\n\t\tdojoAttachPoint=\"_aroundNode,_buttonNode,tableNode,focusNode,stateNode,oneuiBaseNode,_popupStateNode\" cellspacing='0' cellpadding='0'\r\n\t\trole=\"listbox\" aria-haspopup=\"true\"\r\n\t\t><tbody role=\"presentation\"><tr role=\"presentation\"\r\n\t\t\t><td class=\"dijitReset dijitStretch dijitButtonContents dijitButtonNode\" role=\"presentation\"\r\n\t\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"  dojoAttachPoint=\"containerNode\"></span\r\n\t\t\t\t><input type=\"hidden\" ${!nameAttrSetting} dojoAttachPoint=\"valueNode\" value=\"${value}\" aria-hidden=\"true\"\r\n\t\t\t/></td><td class=\"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton\"\r\n\t\t\t\t\tdojoAttachPoint=\"titleNode\" role=\"presentation\"\r\n\t\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" role=\"presentation\"></div\r\n\t\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" role=\"presentation\">&#9660;</div\r\n\t\t\t></td\r\n\t\t></tr></tbody\r\n\t></table\r\n\t><div class='dijitReset dijitValidationContainer dijitInline' dojoAttachPoint=\"iconNode\"\r\n\t\t><div class=\"dijitValidationIcon\"><input class=\"dijitReset dijitInputField dijitValidationInner\" value=\"&#935;\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"/\r\n\t></div></div\r\n></div>"}});define("idx/form/CheckBoxSelect",["dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/event","dojo/_base/window","dojo/query","dojo/keys","dojo/dom-construct","dojo/dom-attr","dojo/dom-class","dojo/dom-style","dojo/dom-geometry","dojo/i18n","dijit/form/_FormSelectWidget","dijit/form/_FormValueWidget","dijit/_HasDropDown","dijit/MenuSeparator","dijit/Tooltip","../util","./_CssStateMixin","./_CheckBoxSelectMenu","./_CheckBoxSelectMenuItem","./_CompositeMixin","./_ValidationMixin","./_FormSelectWidgetA11yMixin","dojo/text!./templates/CheckBoxSelect.html","dojo/i18n!./nls/CheckBoxSelect","dojox/html/ellipsis"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b,_1c){var _1d=_3.getObject("idx.oneui.form",true);return _1d.CheckBoxSelect=_1("idx.form.CheckBoxSelect",[_f,_11,_15,_18,_19,_1a],{baseClass:"idxCheckBoxSelectWrap",oneuiBaseClass:"idxCheckBoxSelect dijitSelect",multiple:true,maxHeight:-1,instantValidate:true,labelSeparator:", ",cssStateNodes:{"titleNode":"dijitDownArrowButton"},templateString:_1b,attributeMap:_3.mixin(_3.clone(_f.prototype.attributeMap),{style:"tableNode"}),required:false,state:"",message:"",tooltipPosition:[],emptyLabel:"&nbsp;",_isLoaded:false,_childrenLoaded:false,postMixInProperties:function(){this._nlsResources=_1c;this.missingMessage||(this.missingMessage=this._nlsResources.missingMessage);this.inherited(arguments);},_fillContent:function(){var _1e=this.options;if(!_1e){_1e=this.options=this.srcNodeRef?_7("> *",this.srcNodeRef).map(function(_1f){if(_1f.getAttribute("type")==="separator"){return {value:"",label:"",selected:false,disabled:false};}return {value:(_1f.getAttribute("data-"+_2._scopeName+"-value")||_1f.getAttribute("value")),label:String(_1f.innerHTML),selected:_1f.getAttribute("selected")||false,disabled:_1f.getAttribute("disabled")||false};},this):[];}if(!this.value){this._set("value",this._getValueFromOpts());}else{if(this.multiple&&typeof this.value=="string"){this._set("value",this.value.split(","));}}this.dropDown=new _16({id:this.id+"_menu"});},_getValueFromOpts:function(){var _20=this.getOptions()||[];return _4.map(_4.filter(_20,function(i){return i.selected&&i.selected!=="false";}),function(i){return i.value;})||[];},postCreate:function(){this._event={"input":"onChange","blur":"_onBlur","focus":"_onFocus"};this.inherited(arguments);this.connect(this.domNode,"onmousemove",_5.stop);this._resize();},startup:function(){this.inherited(arguments);this._resize();},resize:function(){if(_14.isPercentage(this._styleWidth)){_c.set(this.containerNode,"width","");}this.inherited(arguments);},_resize:function(){if(this._deferResize()){return;}_c.set(this.containerNode,"width","");this.inherited(arguments);if(this.oneuiBaseNode.style.width){var _21=this.oneuiBaseNode.style.width,_22=_d.getContentBox(this.oneuiBaseNode).w;if(_21.indexOf("px")||dojo.isNumber(_21)){_21=parseInt(_21);_22=(_21<_22)?_21:_22;}_c.set(this.containerNode,"width",_22-40+"px");}},setStore:function(_23,_24,_25){this.inherited(arguments);var _26=function(_27){var _28=_4.map(_27,function(_29){return _29.value[0];});if(_28.length){this.set("value",_28);}};this.store.fetch({query:{selected:true},onComplete:_26,scope:this});},_getMenuItemForOption:function(_2a){if(!_2a.value&&!_2a.label){return new _12();}else{var _2b=_3.hitch(this,"_updateValue");var _2c=new _17({parent:this,option:_2a,label:_2a.label||this.emptyLabel,onClick:_2b,checked:_2a.selected||false,readOnly:this.readOnly||false,disabled:this.disabled||false});return _2c;}},_addOptionItem:function(_2d){if(this.dropDown){this.dropDown.addChild(this._getMenuItemForOption(_2d));}},_getChildren:function(){if(!this.dropDown){return [];}return this.dropDown.getChildren();},_loadChildren:function(_2e){if(_2e===true){if(this.dropDown){delete this.dropDown.focusedChild;}if(this.options.length){this.inherited(arguments);}else{_4.forEach(this._getChildren(),function(_2f){_2f.destroyRecursive();});}}else{this._updateSelection();}this._isLoaded=false;this._childrenLoaded=true;if(!this._loadingStore){this._setValueAttr(this.value);}},_updateValue:function(){this.set("value",this._getValueFromOpts());},onChange:function(_30){},reset:function(){this.inherited(arguments);_13.hide(this.domNode);this._set("state","");this._set("message","");},_setDisplay:function(_31){var _32=0;var _33;if(_3.isArray(_31)){_32=_31.length;}else{_32=_31?1:0;}_33=_32?_31.join(this.labelSeparator):(this.placeHolder||"");var _34=null;if(this.fieldWidth){var _34={"title":_33};}var _35=_9.create("span",_34,this.containerNode,"only");_b.add(_35,"dijitReset");_b.add(_35,"dijitInline");if(this.fieldWidth){_b.add(_35,"dojoxEllipsis");}_b.add(_35,this.baseClass+"Label");var _36=_6.doc.createTextNode(_33);_9.place(_36,_35,"first");this.focusNode.setAttribute("aria-label",_33);},_setValueAttr:function(_37,_38){if(!this._onChangeActive){_38=null;}if(this._loadingStore){this._pendingValue=_37;return;}var _39=this.getOptions()||[];if(!_3.isArray(_37)){_37=[_37];}_4.forEach(_37,function(i,idx){if(!_3.isObject(i)){i=i+"";}if(typeof i==="string"){_37[idx]=_4.filter(_39,function(_3a){return _3a.value===i;})[0]||{value:"",label:""};}},this);_37=_4.filter(_37,function(i){return i&&i.value;});if(!this.multiple&&(!_37[0]||!_37[0].value)&&_39.length){_37[0]=_39[0];}_4.forEach(_39,function(i){i.selected=_4.some(_37,function(v){return v.value===i.value;});});var val=_4.map(_37,function(i){return i.value;}),_3b=_4.map(_37,function(i){return i.label;});this._setDisplay(this.multiple?_3b:_3b[0]);if(typeof val=="undefined"){return;}_10.prototype._setValueAttr.apply(this,arguments);this._updateSelection();},_setPlaceHolderAttr:null,isLoaded:function(){return this._isLoaded;},loadDropDown:function(_3c){this._loadChildren(true);this._isLoaded=true;_3c();},closeDropDown:function(){this.inherited(arguments);if(this.dropDown&&this.dropDown.menuTableNode){this.dropDown.menuTableNode.style.width="";}},invertSelection:function(_3d){_4.forEach(this.options,function(i){i.selected=!i.selected;});this._updateSelection();this._updateValue();},_updateSelection:function(){this.inherited(arguments);this._handleOnChange(this.value);_4.forEach(this._getChildren(),function(_3e){_3e._updateBox();});},_setDisabledAttr:function(_3f){this.inherited(arguments);_4.forEach(this._getChildren(),function(_40){if(_40&&_40.set){_40.set("disabled",_3f);}});},_setReadOnlyAttr:function(_41){this.inherited(arguments);_4.forEach(this._getChildren(),function(_42){if(_42&&_42.set){_42.set("readOnly",_41);}});},_isEmpty:function(){return !_4.some(this.getOptions(),function(opt){return opt.selected&&opt.value!=null&&opt.value.toString().length!=0;});},_setLabelAttr:function(_43){this.inherited(arguments);this.focusNode.setAttribute("aria-labelledby",this.id+"_label");},_onDropDownMouseDown:function(e){if(this.disabled){return;}_5.stop(e);this._docHandler=this.connect(_6.doc,"onmouseup","_onDropDownMouseUp");this.toggleDropDown();},toggleDropDown:function(){if(this.disabled){return;}if(!this._opened){if(!this.isLoaded()){this.loadDropDown(_3.hitch(this,"openDropDown"));return;}else{this.openDropDown();}}else{this.closeDropDown();}},_onKey:function(e){if(this.disabled){return;}var d=this.dropDown,_44=e.target;if(d&&this._opened&&d.handleKey){if(d.handleKey(e)===false){_5.stop(e);return;}}if(d&&this._opened&&e.keyCode==_8.ESCAPE){this.closeDropDown();_5.stop(e);}else{if(!this._opened&&(e.keyCode==_8.DOWN_ARROW||((e.keyCode==_8.ENTER||e.keyCode==" ")&&((_44.tagName||"").toLowerCase()!=="input"||(_44.type&&_44.type.toLowerCase()!=="text"))))){this._toggleOnKeyUp=true;_5.stop(e);}}},_setDisabledAttr:function(){this.inherited(arguments);this._refreshState();},uninitialize:function(_45){if(this.dropDown&&!this.dropDown._destroyed){this.dropDown.destroyRecursive(_45);delete this.dropDown;}this.inherited(arguments);}});});