//>>built
define("idx/form/_CompositeMixin",["dojo/_base/declare","dojo/_base/lang","dojo/aspect","dojo/dom-attr","dojo/dom","dojo/dom-construct","dojo/dom-geometry","dojo/i18n","dojo/query","dojo/dom-class","dojo/dom-style","dojo/on","dijit/_base/wai","idx/widget/HoverHelpTooltip","../util","../string","./_FocusManager"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,on,_c,_d,_e,_f,_10){return _1("idx.form._CompositeMixin",null,{labelAlignment:"horizontal",label:"",labelWidth:"",fieldWidth:"",hintPosition:"inside",hint:"",required:false,unit:"",_focusManager:_10,help:"",_errorIconWidth:27,resize:function(){if(_e.isPercentage(this._styleWidth)){_b.set(this.labelWrap,{width:""});_b.set(this.oneuiBaseNode,{width:""});}if(this._resizeTimeout){clearTimeout(this._resizeTimeout);delete this._resizeTimeout;}this._resizeTimeout=setTimeout(_2.hitch(this,this._resize),250);},_deferResize:function(){if(!this._started){if(!this._resizeHandle){this._resizeHandle=_3.after(this,"startup",_2.hitch(this,this._resize));}return true;}else{if(this._resizeHandle){this._resizeHandle.remove();delete this._resizeHandle;}return false;}},_resize:function(){if(this._resizeTimeout){clearTimeout(this._resizeTimeout);delete this._resizeTimeout;}var _11=this._deferResize();if(_11){return;}var _12=this.labelWidth,_13=this.fieldWidth,_14=this._styleWidth;if(!(_12||_13||_14)){_b.set(this.labelWrap,{width:""});_b.set(this.oneuiBaseNode,{width:""});return;}var _15=_7.getContentBox(this.domNode).w;if(!_14){if(_e.isPercentage(_12)){_b.set(this.labelWrap,"width","");}if(_e.isPercentage(_13)){_b.set(this.oneuiBaseNode,"width","");}}if(this.label&&this.labelAlignment=="horizontal"){if(_12){if(_e.isPercentage(_12)){_12=Math.floor(_15*parseInt(_12)/100)-10;}_b.set(this.labelWrap,"width",_e.normalizedLength(_12,this.domNode)+"px");}else{_b.set(this.labelWrap,"width","");}if(_13){if(_e.isPercentage(_13)){_13=Math.floor(_15*parseInt(_13)/100);}_b.set(this.oneuiBaseNode,"width",_e.normalizedLength(_13,this.domNode)-this._errorIconWidth-2+"px");}else{_b.set(this.oneuiBaseNode,"width","");}if(_14&&!_13){var _16=_7.getMarginBox(this.labelWrap).w;var _17=_15-this._errorIconWidth-_16-2;if(_17>0){_b.set(this.oneuiBaseNode,"width",_17+"px");}}}else{if(_14){_b.set(this.oneuiBaseNode,"width",_15-this._errorIconWidth-2+"px");}else{if(_13&&!_e.isPercentage(_13)){_b.set(this.oneuiBaseNode,"width",_e.normalizedLength(_13,this.domNode)-this._errorIconWidth-2+"px");}else{_b.set(this.oneuiBaseNode,"width","");}}}},_setStyleAttr:function(_18){this.inherited(arguments);this._styleWidth=_e.getValidCSSWidth(_18);this._created&&this._resize();},_setLabelWidthAttr:function(_19){this._set("labelWidth",_19);this._created&&this._resize();},_setFieldWidthAttr:function(_1a){this._set("fieldWidth",_1a);this._created&&this._resize();},_setLabelAlignmentAttr:function(_1b){var h=_1b=="horizontal";_a.toggle(this.labelWrap,"dijitInline",h);_9(".idxCompContainer",this.domNode).toggleClass("dijitInline",h);this._set("labelAlignment",_1b);this._resize();},_setupHelpListener:function(){if(this._helpListener){return;}var _1c=function(e){if(this.widget.helpTooltip){this.widget.helpTooltip.close(true);}if(this.handle){this.handle.remove();delete this.handle;this.widget._blurHandler=null;}};var _1d=function(e){var _1e=e.keyCode;if(e.type=="keydown"){if(e.ctrlKey&&e.shiftKey&&(_1e==191)&&this.helpTooltip&&this._help){this.helpTooltip.open(this.helpNode);if(e.target&&!this._blurHandler){var _1f={handle:null,widget:this};this._blurHandler=_1f.handle=on(e.target,"blur",_2.hitch(_1f,_1c));}}}};var _20=(this.oneuiBaseNode)?this.oneuiBaseNode:this.focusNode;if(_20){this._keyListener=this.own(on(_20,"keydown",_2.hitch(this,_1d)));}},_setHelpAttr:function(_21){this.help=_21;this._help=_21=_f.nullTrim(_21);if(_21){if(!this.helpNode){this.helpNode=_6.toDom("<div class='dijitInline idxTextBoxHoverHelp'><span class='idxHelpIconAltText'>?</span></div>");_6.place(this.helpNode,this.compLabelNode,"after");this.helpTooltip=new _d({connectId:[this.helpNode],label:_21,position:["above","below"],forceFocus:false});this._setupHelpListener();}else{this._setupHelpListener();this.helpTooltip.set("label",_21);_a.remove(this.helpNode,"dijitHidden");}}else{if(this.helpNode){this.helpTooltip.set("label","");_a.add(this.helpNode,"dijitHidden");}}},_setLabelAttr:function(_22){this.compLabelNode.innerHTML=_22;_a.toggle(this.labelWrap,"dijitHidden",/^\s*$/.test(_22));this._set("label",_22);},_setRequiredAttr:function(_23){_c.setWaiState(this.focusNode,"required",_23+"");this._set("required",_23);this._refreshState();},_refreshState:function(){if(!this._created){return;}if(this.disabled){this._set("state","");}else{if(this.required&&this._isEmpty(this.value)&&(this.state=="")){this._set("state","Incomplete");}}},_setHintPositionAttr:function(_24){if(!this.compHintNode){return;}_a.toggle(this.compHintNode,"dijitVisible",_24!="inside");this._set("hintPosition",_24);this.set("hint",this.hint);},_setHintAttr:function(_25){if(!this.compHintNode){return;}this.set("placeHolder",this.hintPosition=="inside"?_25:"");this.compHintNode.innerHTML=this.hintPosition=="inside"?"":_25;if(this.hintPosition=="outside"){_4.set(this.compHintNode,"id",this.id+"_hint_outside");}_c.setWaiState(this.focusNode,"describedby",this.id+"_hint_"+this.hintPosition);this._set("hint",_25);},_setPlaceHolderAttr:function(v){this._set("placeHolder",v);if(!this._phspan){this._attachPoints.push("_phspan");this._phspan=dojo.create("span",{className:"dijitPlaceHolder dijitInputField",id:this.id+"_hint_inside"},this.focusNode,"after");}this._phspan.innerHTML="";this._phspan.appendChild(document.createTextNode(v));this._phspan.style.display=(this.placeHolder&&!this.focused&&!this.textbox.value)?"":"none";},_setUnitAttr:function(_26){if(!this.compUnitNode){return;}this.compUnitNode.innerHTML=_26;_a.toggle(this.compUnitNode,"dijitHidden",/^\s*$/.test(_26));this._set("unit",_26);},_isValidFocusNode:function(_27){return _5.isDescendant(_27,this.oneuiBaseNode)||!_5.isDescendant(_27,this.domNode);},reset:function(){this.set("state",this.required?"Incomplete":"");this.message="";this.inherited(arguments);}});});