//>>built
define("idx/form/_InputListMixin",["dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/sniff","dojo/dom-attr","dojo/dom-class","dojo/dom-style","dojo/query","dojo/i18n","idx/widget/HoverHelpTooltip","dijit/form/_FormValueWidget","dojo/i18n!./nls/_InputListMixin"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){return _1("idx.form._InputListMixin",null,{instantValidate:true,groupAlignment:"vertical",lastFocusedChild:null,postCreate:function(){this._event={"input":"onChange","blur":"_onBlur","focus":"_onFocus"};this.inherited(arguments);this.connect(this,"focusChild",function(){this.lastFocusedChild=this.focusedChild;});_6.set(this.stateNode,{tabIndex:-1});this.initLoaded=true;},setStore:function(_e,_f,_10){this.inherited(arguments);var _11=function(_12){var _13=_4.map(_12,function(_14){return _14.value[0];});if(_13.length){this.set("value",_13);}};this.store.fetch({query:{selected:true},onComplete:_11,scope:this});},postMixInProperties:function(){this._nlsResources=_d;this.missingMessage||(this.missingMessage=this._nlsResources.invalidMessage);this.inherited(arguments);},_fillContent:function(){var _15=this.options;if(!_15){_15=this.options=this.srcNodeRef?_9("> *",this.srcNodeRef).map(function(_16){if(_16.getAttribute("type")==="separator"){return {value:"",label:"",selected:false,disabled:false};}return {value:(_16.getAttribute("data-"+_2._scopeName+"-value")||_16.getAttribute("value")),label:String(_16.innerHTML),selected:_16.getAttribute("selected")||false,disabled:_16.getAttribute("disabled")||false};},this):[];}if(!this.value){this._set("value",this._getValueFromOpts());}else{if(this.multiple&&typeof this.value=="string"){this._set("value",this.value.split(","));}}},_setValueAttr:function(_17,_18){if(!this._onChangeActive){_18=null;}if(this._loadingStore){this._pendingValue=_17;return;}var _19=this.getOptions()||[];if(!_3.isArray(_17)){_17=[_17];}_4.forEach(_17,function(i,idx){if(!_3.isObject(i)){i=i+"";}if(typeof i==="string"){_17[idx]=_4.filter(_19,function(_1a){return _1a.value===i;})[0]||{value:"",label:""};}},this);_17=_4.filter(_17,function(i){return i&&i.value;});_4.forEach(_19,function(i){i.selected=_4.some(_17,function(v){return v.value===i.value;});});var val=_4.map(_17,function(i){return i.value;}),_1b=_4.map(_17,function(i){return i.label;});if(typeof val=="undefined"){return;}this._setDisplay(this.multiple?_1b:_1b[0]);_c.prototype._setValueAttr.apply(this,arguments);this._updateSelection();},_getValueFromOpts:function(){var _1c=this.getOptions()||[];if(!this.multiple&&_1c.length){var opt=_4.filter(_1c,function(i){return i.selected&&i.selected!=="false";})[0];if(opt&&opt.value){return opt.value;}}else{if(this.multiple){return _4.map(_4.filter(_1c,function(i){return i.selected&&i.selected!=="false";}),function(i){return i.value;})||[];}}return "";},onAfterAddOptionItem:function(_1d,_1e){},onChange:function(_1f){this.validate(this.focused);},reset:function(){this.inherited(arguments);this.displayMessage("");},_onMouseDown:function(e){this.mouseFocus=true;_6.set(this.domNode,"tabIndex","-1");if(_5("ie")<9||_5("quirks")){e.cancelBubble=true;}else{e.stopPropagation();}},_onContainerFocus:function(evt){if(evt.target!==this.domNode){return;}if(!this.mouseFocus){if(this.lastFocusedChild){this.focusChild(this.lastFocusedChild);}else{this.focusFirstChild();}}_6.set(this.domNode,"tabIndex","-1");},_updateSelection:function(){this._set("value",this._getValueFromOpts());var val=this.value;if(!_3.isArray(val)){val=[val];}if(val&&val[0]){_4.forEach(this._getChildren(),function(_20){var _21=_4.some(val,function(v){return _20.option&&(v===_20.option.value);});_7.toggle(_20.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),_21);},this);}_6.set(this.valueNode,"value",this.value);_4.forEach(this._getChildren(),function(_22){_22._updateBox();});},_getChildren:function(){return this.getChildren();},invertSelection:function(_23){_4.forEach(this.options,function(i){i.selected=!i.selected;});this._updateSelection();this._handleOnChange(this.value);},_setDisabledAttr:function(_24){this.inherited(arguments);_24||_6.remove(this.valueNode,"disabled");_4.forEach(this.getChildren(),function(_25){if(_25&&_25.set){_25.set("disabled",_24);}});},_setReadOnlyAttr:function(_26){this.inherited(arguments);_4.forEach(this.getChildren(),function(_27){if(_27&&_27.set){_27.set("readOnly",_26);}});},_setGroupAlignmentAttr:function(_28){this._set("groupAlignment",_28);_4.forEach(this.getChildren(),function(_29){_7.toggle(_29.domNode,"dijitInline",!(_28=="vertical"));},this);},_setRequiredAttr:function(_2a){this._set("required",_2a);this.inherited(arguments);},_isEmpty:function(){if(this.initLoaded){return false;}return this.value=="";},_relayout:function(_2b){_8.set(_2b,"zoom","1");_8.set(_2b,"zoom","");},startup:function(){this.inherited(arguments);this.initLoaded=false;},_setLabelAttr:function(_2c){this.compLabelNode.innerHTML=_2c;_9(".idxLabel",this.domNode).toggleClass("dijitHidden",/^\s*$/.test(_2c));this._set("label",_2c);_6.set(this.stateNode,"aria-label",_2c);},uninitialize:function(){_b.hide(this.domNode);_4.forEach(this._getChildren(),function(_2d){_2d.destroyRecursive();});this.inherited(arguments);}});});