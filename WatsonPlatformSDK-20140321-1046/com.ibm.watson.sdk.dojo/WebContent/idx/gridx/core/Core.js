//>>built
define("idx/gridx/core/Core",["require","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/Deferred","dojo/DeferredList","./model/Model","./Row","./Column","./Cell","./_Module"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){var _c=_4.delegate,_d=_4.isFunction,_e=_4.isString,_f=_4.hitch,_10=_3.forEach;function _11(mod){var p=mod.moduleClass.prototype;return (p.forced||[]).concat(p.optional||[]);};function _12(_13){var cs={},c,i,len;if(_4.isArray(_13)){for(i=0,len=_13.length;i<len;++i){c=_13[i];c.index=i;c.id=c.id||String(i+1);cs[c.id]=c;}}return cs;};function _14(_15,_16){if(_16){for(var _17 in _16){var bp=_15[_17],ap=_16[_17];if(bp&&_4.isObject(bp)&&!_d(bp)){_14(bp,ap);}else{_15[_17]=ap;}}}};function _18(_19){var _1a=[],_1b=_19.coreModules.length;_10(_19.modules,function(m,i){if(_d(m)||_e(m)){m={moduleClass:m};}if(m){var mc=m.moduleClass;if(_e(mc)){try{mc=m.moduleClass=_1(mc);}catch(e){console.error(e);}}if(_d(mc)){_1a.push(m);return;}}console.error("The "+(i+1-_1b)+"-th declared module can NOT be found, please require it before using it");});_19.modules=_1a;};function _1c(_1d){var _1e=_b._modules,_1f=_1d.modules,i,j,k,p,_20,_21,err;for(i=0;i<_1f.length;++i){p=_1f[i].moduleClass.prototype;_20=(p.forced||[]).concat(p.required||[]);for(j=0;j<_20.length;++j){_21=_20[j];for(k=_1f.length-1;k>=0;--k){if(_1f[k].moduleClass.prototype.name===_21){break;}}if(k<0){if(_1e[_21]){_1f.push({moduleClass:_1e[_21]});}else{err=1;console.error("Forced/Required dependent module '"+_21+"' is NOT found for '"+p.name+"' module.");}}}}if(err){throw new Error("Some forced/required dependent modules are NOT found.");}};function _22(_23){var i,_24={},_25=[];_10(_23.modules,function(m){_24[m.moduleClass.prototype.name]=m;});for(i in _24){_25.push(_24[i]);}_23.modules=_25;};function _26(_27){var _28=_27.modules,i,_29;for(i=_28.length-1;i>=0;--i){_29=_28[i].moduleClass.prototype.modelExtensions;if(_29){[].push.apply(_27.modelExtensions,_29);}}};function arr(_2a,_2b,_2c,_2d,_2e,pid){var i=_2d||0,end=_2e>=0?_2d+_2e:_2b,r=[];for(;i<end&&i<_2b;++i){r.push(_2a[_2c](i,0,pid));}return r;};function _2f(_30,_31,_32){var m,a,_33=_30._modules;for(m in _33){m=_33[m].mod;a=m[_32+"Mixin"];if(_d(a)){a=a.apply(m);}_4.mixin(_31,a||{});}return _31;};function _34(_35,_36,key){var _37=_35._modules,m=_37[key],mod=m.mod,d=mod.loaded;if(!m.done){m.done=1;new _6(_3.map(_3.filter(m.deps,function(_38){return _37[_38];}),_f(_35,_34,_35,_36)),0,1).then(function(){if(mod.load){mod.load(m.args,_36);}else{if(d.fired<0){d.callback();}}});}return d;};return _2([],{setStore:function(_39){if(this.store!=_39){this.store=_39;this.model.setStore(_39);}},setColumns:function(_3a){var t=this;t.structure=_3a;t._columns=_4.clone(_3a);t._columnsById=_12(t._columns);if(t.model){t.model._cache.onSetColumns(t._columnsById);}},row:function(row,_3b,_3c){var t=this;if(typeof row=="number"&&!_3b){row=t.model.indexToId(row,_3c);}if(t.model.byId(row)){t._rowObj=t._rowObj||_2f(t,new _8(t),"row");return _c(t._rowObj,{id:row});}return null;},column:function(_3d,_3e){var t=this,c,a,obj={};if(typeof _3d=="number"&&!_3e){c=t._columns[_3d];_3d=c&&c.id;}c=t._columnsById[_3d];if(c){t._colObj=t._colObj||_2f(t,new _9(t),"column");for(a in c){if(t._colObj[a]===undefined){obj[a]=c[a];}}return _c(t._colObj,obj);}return null;},cell:function(row,_3f,_40,_41){var t=this,r=row instanceof _8?row:t.row(row,_40,_41);if(r){var c=_3f instanceof _9?_3f:t.column(_3f,_40);if(c){t._cellObj=t._cellObj||_2f(t,new _a(t),"cell");return _c(t._cellObj,{row:r,column:c});}}return null;},columnCount:function(){return this._columns.length;},rowCount:function(_42){return this.model.size(_42);},columns:function(_43,_44){return arr(this,this._columns.length,"column",_43,_44);},rows:function(_45,_46,_47){return arr(this,this.rowCount(_47),"row",_45,_46,_47);},onModulesLoaded:function(){},_init:function(){var t=this,d=t._deferStartup=new _5();t.modules=t.modules||[];t.modelExtensions=t.modelExtensions||[];t.setColumns(t.structure);_18(t);_1c(t);_22(t);_26(t);t.model=new _7(t);t.when=_f(t.model,t.model.when);t._create();t._preload();t._load(d).then(_f(t,"onModulesLoaded"));},_uninit:function(){var t=this,_48=t._modules,m;for(m in _48){_48[m].mod.destroy();}if(t.model){t.model.destroy();}},_create:function(){var t=this,_49=t._modules={};_10(t.modules,function(mod){var m,key=mod.moduleClass.prototype.name;if(!_49[key]){_49[key]={args:mod,mod:m=new mod.moduleClass(t,mod),deps:_11(mod)};if(m.getAPIPath){_14(t,m.getAPIPath());}}});},_preload:function(){var m,_4a=this._modules;for(m in _4a){m=_4a[m];if(m.mod.preload){m.mod.preload(m.args);}}},_load:function(_4b){var dl=[],m;for(m in this._modules){dl.push(_34(this,_4b,m));}return new _6(dl,0,1);}});});