//>>built
define("idx/gridx/modules/Bar",["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dijit/registry","dijit/a11y","dojo/dom-construct","../core/_Module","../core/util"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){return _8.register(_2(_8,{name:"bar",getAPIPath:function(){return {bar:this};},constructor:function(){this.defs=[];},load:function(_a,_b){var t=this;t._init();t.loaded.callback();_b.then(function(){t._forEachPlugin(function(_c){if(_c&&_c.startup){_c.startup();}});setTimeout(function(){t.grid.vLayout.reLayout();},10);});},destroy:function(){this.inherited(arguments);this._forEachPlugin(function(_d){if(_d.destroy){_d.destroy();}});},_init:function(){var t=this,_e,_f=t._defDict={},_10=function(row){row.sort(function(a,b){return a.col-b.col;});},_11=function(def){if(_3.isArray(def)&&def.length&&!_3.isArray(def[0])){def=[def];}return def;},top=_11(t.arg("top")),_12=_11(t.arg("bottom"));_4.forEach(t.defs,function(def){var _13=_f[def.bar]=_f[def.bar]||[],row=_13[def.row]=_13[def.row]||[];row.push(def);_13.priority="priority" in def?def.priority:_13.priority||-5;_13.container=def.container?def.container:_13.container||"headerNode";_13.barClass=def.barClass?def.barClass:_13.barClass||"";});for(_e in _f){_4.forEach(_f[_e],_10);}if(top){_f.top=top.concat(_f.top||[]);}if(_f.top){_f.top.priority=-5;_f.top.container="headerNode";}if(_12){_f.bottom=(_f.bottom||[]).concat(_12);}if(_f.bottom){_f.bottom.priority=5;_f.bottom.container="footerNode";}for(_e in _f){var def=_f[_e],_14=_e+"Node",_15=t[_14]=_7.create("div",{"class":"gridxBar "+def.barClass||"",innerHTML:"<table border=\"0\" cellspacing=\"0\"></table>"});t.grid.vLayout.register(t,_14,def.container,def.priority);t._initFocus(_e,def.priority);t.plugins=t.plugins||{};t.plugins[_e]=t._parse(def,_15.firstChild);}},_parse:function(_16,_17){var _18,_19=[],_1a=_7.create("tbody"),_1b=function(n,def,_1c,_1d){if(def[_1d]){n.setAttribute(_1c||_1d,def[_1d]);delete def[_1d];}};for(var i=0,_1e=_16.length;i<_1e;++i){var _1f=[],row=_16[i],tr=_7.create("tr");for(var j=0,_20=row.length;j<_20;++j){var def=this._normalizePlugin(row[j]),td=_7.create("td");_4.forEach(["colSpan","rowSpan","style"],_3.partial(_1b,td,def,0));_1b(td,def,"class","className");_18=null;try{if(def.plugin){_18=_5.byId(def.plugin);td.appendChild(_18.domNode);}else{if(def.pluginClass){var cls=def.pluginClass;delete def.pluginClass;_18=new cls(def);td.appendChild(_18.domNode);}else{if(def.content){td.innerHTML=def.content;}}}}catch(e){console.error(e);}_1f.push(_18||td);tr.appendChild(td);}_19.push(_1f);_1a.appendChild(tr);}_17.appendChild(_1a);return _19;},_normalizePlugin:function(def){if(!def||!_3.isObject(def)||_3.isFunction(def)){def={pluginClass:def};}else{if(def.domNode){def={plugin:def};}else{def=_3.mixin({},def);}}if(_3.isString(def.pluginClass)){try{def.pluginClass=_1(def.pluginClass);}catch(e){console.error(e);}}if(_3.isFunction(def.pluginClass)){def.grid=this.grid;}else{def.pluginClass=null;}return def;},_forEachPlugin:function(_21){function _22(_23){if(_23){for(var i=0,_24=_23.length;i<_24;++i){var row=_23[i];for(var j=0,_25=row.length;j<_25;++j){_21(row[j]);}}}};var _26=this.plugins;for(var _27 in _26){_22(_26[_27]);}},_initFocus:function(_28,_29){var t=this,f=t.grid.focus,_2a=t[_28+"Node"];if(f&&_2a){f.registerArea({name:_28+"bar",priority:_29,focusNode:_2a,doFocus:_3.hitch(t,t._doFocus,_2a),doBlur:_3.hitch(t,t._doBlur,_2a)});}},_doFocus:function(_2b,evt,_2c){this.grid.focus.stopEvent(evt);var _2d=_6._getTabNavigable(_2b),n=_2d[_2c<0?"last":"first"];if(n){n.focus();}return !!n;},_doBlur:function(_2e,evt,_2f){var _30=_6._getTabNavigable(_2e);return evt?evt.target==(_2f<0?_30.first:_30.last):true;}}));});