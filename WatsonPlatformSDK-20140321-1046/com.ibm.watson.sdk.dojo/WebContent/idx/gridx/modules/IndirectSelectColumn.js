//>>built
define("idx/gridx/modules/IndirectSelectColumn",["dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/_base/query","dojo/_base/lang","dojo/dom-class","dojo/_base/Deferred","dojo/keys","../core/_Module","../core/util","./RowHeader"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){var _b="__indirectSelect__";return _1(_9,{name:"indirectSelect",required:["selectRow"],position:0,width:"20px",all:true,preload:function(){var t=this,g=t.grid,sr=g.select.row,_c=g._columns,w=t.arg("width"),_d={id:_b,decorator:_5.hitch(this,"_createSelector"),headerStyle:"text-align: center;",style:"text-align: center;",rowSelectable:true,sortable:false,filterable:false,editable:false,declaredWidth:w,width:w};t.batchConnect([sr,"onHighlightChange","_onHighlightChange"],[sr,"onSelectionChange","_onSelectionChange"],[sr,"clear","_onClear"],[g.body,"onMoveToCell",function(r,c,e){var _e={columnId:_b};if(g._columns[c].id==_b){t._onMouseOver(_e);}else{t._onMouseOut();}}],[g,"onCellMouseOver","_onMouseOver"],[g,"onCellMouseOut","_onMouseOut"]);_c.splice(t.arg("position"),0,_d);g._columnsById[_d.id]=_d;_2.forEach(_c,function(c,i){c.index=i;});if(sr.selectByIndex&&t.arg("all")){t._allSelected={};_d.name=t._createSelectAllBox();t.connect(g,"onHeaderCellMouseDown",function(e){if(e.columnId==_b){t._onSelectAll();}});t.connect(g,"onHeaderCellKeyDown",function(e){if(e.columnId==_b&&e.keyCode==_8.SPACE){t._onSelectAll();}});}g.header._build();},_createSelectAllBox:function(){return this._createCheckBox(this._allSelected[this._getPageId()]);},_getPageId:function(){return this.grid.body.rootStart+","+this.grid.body.rootCount;},_createSelector:function(_f,_10){var _11=this.model.getMark(_10);return this._createCheckBox(_11===true,_11=="mixed");},_createCheckBox:function(_12,_13){var _14=this._getDijitClass();return ["<span role=\"",this._isSingle()?"radio":"checkbox","\" class=\"gridxIndirectSelectionCheckBox dijitReset dijitInline ",_14," ",_12?_14+"Checked":"",_13?_14+"Partial":"","\" aria-checked=\"",_12?"true":_13?"mixed":"false","\"><span class=\"gridxIndirectSelectionCheckBoxInner\">",_12?"&#10003;":_13?"&#9646;":"&#9744;","</span></span>"].join("");},_getDijitClass:function(){return this._isSingle()?"dijitRadio":"dijitCheckBox";},_isSingle:function(){var _15=this.grid.select.row;return _15.hasOwnProperty("multiple")&&!_15.arg("multiple");},_onClear:function(_16){var cls=this._getDijitClass()+"Checked";var g=this.grid;_4("."+cls,this.grid.bodyNode).removeClass(cls);if(g.select.row.isSelected(_16)){_4("[rowid=\""+g._escapeId(_16)+"\"].gridxRow .gridxIndirectSelectionCheckBox",g.bodyNode).addClass(cls);}},_onHighlightChange:function(_17,_18){var _19=_4("[visualindex=\""+_17.row+"\"].gridxRow .gridxIndirectSelectionCheckBox",this.grid.bodyNode)[0];if(_19){var _1a=this._getDijitClass(),_1b=_18=="mixed",_1c=_18&&!_1b;_6.toggle(_19,_1a+"Checked",_1c);_6.toggle(_19,_1a+"Partial",_1b);_19.setAttribute("aria-checked",_1c?"true":_1b?"mixed":"false");_19.firstChild.innerHTML=_1c?"&#10003;":_1b?"&#9646;":"&#9744;";}},_onMouseOver:function(e){if(e.columnId==_b){var sr=this.grid.select.row;if(!sr.triggerOnCell){this._triggerOnCell=false;sr.triggerOnCell=true;}if(!sr.holdingCtrl){this._holdingCtrl=false;sr.holdingCtrl=true;}}else{this._onMouseOut();}},_onMouseOut:function(){var sr=this.grid.select.row;if(this.hasOwnProperty("_triggerOnCell")){sr.triggerOnCell=false;delete this._triggerOnCell;}if(this.hasOwnProperty("_holdingCtrl")){sr.holdingCtrl=false;delete this._holdingCtrl;}},_onSelectAll:function(){var t=this,g=t.grid,_1d=g.body;g.select.row[t._allSelected[t._getPageId()]?"deselectByIndex":"selectByIndex"]([0,_1d.visualCount-1]);},_onSelectionChange:function(_1e){var t=this,d,g=t.grid,_1f,_20=g.body,_21=t.model,_22=_20.rootStart,_23=_20.rootCount;var _24=_2.filter(_1e,function(id){return !_21.treePath(id).pop();});if(_23===_21.size()){_1f=_23==_24.length;}else{d=new _7();_21.when({start:_22,count:_23},function(){var _25=_2.filter(_2.map(_24,function(id){return _21.idToIndex(id);}),function(_26){return _26>=_22&&_26<_22+_23;});_1f=_23==_25.length;d.callback();});}_7.when(d,function(){if(t.arg("all")){t._allSelected[t._getPageId()]=_1f;var _27=t._createSelectAllBox();g._columnsById[_b].name=_27;g.header.getHeaderNode(_b).innerHTML=_27;}});}});});