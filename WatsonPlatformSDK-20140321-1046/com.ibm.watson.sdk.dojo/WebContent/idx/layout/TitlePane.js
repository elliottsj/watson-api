//>>built
define("idx/layout/TitlePane",["dojo/_base/declare","dojo/_base/lang","dijit/TitlePane","./ContentPane","dijit/layout/_LayoutWidget","dojo/_base/array","dojo/on","dojo/aspect","dojo/_base/event","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dojo/dom-attr","dojo/dom-geometry","dojo/query","dojo/keys","dijit/_WidgetBase","dijit/form/Button","../util","../string","../widget/_MaximizeMixin","dojo/NodeList-dom","../ext","dijit/layout/BorderContainer"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15){var _16=_f.NodeList;return _1("idx.layout.TitlePane",[_3,_4,_5],{baseClass:"dijitTitlePane",idxBaseClass:"idxTitlePane",collapsible:true,autoHideActions:false,closable:false,refreshable:false,resizable:false,resizeDuration:0,helpURL:"",defaultActionDisplay:"",constructor:function(_17,_18){this._titleActions=[];this._built=false;this._started=false;this._idxStarted=false;this._maximizeMixin=new _15({inPlace:true});},destroy:function(){this._destroyDefaultCloseButton();this._destroyDefaultRefreshButton();this._destroyDefaultResizeButton();this._destroyDefaultHelpButton();if(this._actionsLookup){for(var _19 in this._actionsLookup){var _1a=this._actionsLookup[_19];_6.forEach(_1a,function(_1b){if(_1b.handle){_1b.handle.remove();delete _1b.handle;}});}}_6.forEach(this.getTitleActionChildren(),function(_1c){_1c.destroyRecursive();});this.inherited(arguments);},_killActionsMouseEvent:function(e){this.set("active",false);this._setStateClass();_b.remove(this.domNode,this.baseClass+"Active");_b.remove(this.titleBarNode,this.baseClass+"TitleActive");if(e){_9.stop(e);}},_killActionsKeyEvent:function(e){if(e){if(e.keyCode==_10.SPACE||e.keyCode==_10.ENTER){this.set("active",false);this._setStateClass();_b.remove(this.domNode,this.baseClass+"Active");_b.remove(this.titleBarNode,this.baseClass+"TitleActive");_9.stop(e);}}},buildRendering:function(){this.inherited(arguments);this._titleActionsNode=_a.create("div",{"class":this.idxBaseClass+"Actions"},this.focusNode);this.own(_7(this._titleActionsNode,"mousedown",_2.hitch(this,this._killActionsMouseEvent)));this.own(_7(this._titleActionsNode,"click",_2.hitch(this,this._killActionsMouseEvent)));this.own(_7(this._titleActionsNode,"dblclick",_2.hitch(this,this._killActionsMouseEvent)));this.own(_7(this._titleActionsNode,"keypress",_2.hitch(this,this._killActionsKeyEvent)));this.own(_7(this._titleActionsNode,"keydown",_2.hitch(this,this._killActionsKeyEvent)));this.own(_7(this._titleActionsNode,"keyup",_2.hitch(this,this._killActionsKeyEvent)));this.own(_8.after(this._maximizeMixin,"_restore",_2.hitch(this,this._onRestore),true));var _1d=this.id+"_titleNode";if(_d.has(this.titleNode,"id")){_1d=_d.get(this.titleNode,"id");}else{_d.set(this.titleNode,"id",_1d);}if(!_d.has(this.containerNode,"aria-labelledby")){_d.set(this.containerNode,"aria-labelledby",_1d);}_b.add(this.domNode,this.idxBaseClass);this._built=true;this._updateCollapsibility();this._updateActionHiding();this._setupNodes();},postMixInProperties:function(){this.inherited(arguments);this._setupMaximizeAnimation();},_setupNodes:function(){if(!this._built){return;}this._regionLookup={body:this.containerNode,titleActions:this._titleActionsNode};this._actionsLookup={titleActions:this._titleActions};},postCreate:function(){this.inherited(arguments);_c.set(this._titleActionsNode,"width","auto");},toggle:function(){if(((this.collapsible)||(!this.open))&&(!this._refreshing)){this.inherited(arguments);}},_setCollapsibleAttr:function(_1e){this.collapsible=_1e;this._updateCollapsibility();},_updateCollapsibility:function(){if(!this._built){return;}if(this.collapsible){_b.remove(this.titleBarNode,this.idxBaseClass+"NoCollapse");}else{_b.add(this.titleBarNode,this.idxBaseClass+"NoCollapse");}if(!this.collapsible){this.toggle();}},_setAutoHideActionsAttr:function(_1f){this.autoHideActions=_1f;this._updateActionHiding();},_updateActionHiding:function(){if(!this._built){return;}if(this.autoHideActions){_b.add(this.domNode,this.idxBaseClass+"AutoHide");}else{_b.remove(this.domNode,this.idxBaseClass+"AutoHide");}},_setDefaultActionDisplayAttr:function(_20){this.defaultActionDisplay=_20;if(this._closeButton){this._closeButton.set("displayMode",this.defaultActionDisplay);}if(this._refreshButton){this._refreshButton.set("displayMode",this.defaultActionDisplay);}if(this._resizeButton){this._resizeButton.set("displayMode",this.defaultActionDisplay);}if(this._helpButton){this._helpButton.set("displayMode",this.defaultActionDisplay);}this.resize();},_setClosableAttr:function(_21){var _22=this.closable;this.closable=_21;if(!this._idxStarted){return;}if(_22==this.closable){return;}if(this.closable){this._createDefaultCloseButton();}else{this._destroyDefaultCloseButton();}},_setRefreshableAttr:function(_23){var _24=this.refreshable;this.refreshable=_23;if(!this._idxStarted){return;}if(_24==this.refreshable){return;}if(this.refreshable){this._createDefaultRefreshButton();}else{this._destroyDefaultRefreshButton();}},_setResizableAttr:function(_25){var _26=this.resizable;this.resizable=_25;if(!this._idxStarted){return;}if(_26==this.resizable){return;}if(this.resizable){this._createDefaultResizeButton();}else{this._destroyDefaultResizeButton();if(this._maximized){this._restorePane();}}},_setResizeDurationAttr:function(_27){this.resizeDuration=_27;this._setupMaximizeAnimation();},_setupMaximizeAnimation:function(){if(this.resizeDuration>0){this._maximizeMixin.useAnimation=true;this._maximizeMixin.duration=this.resizeDuration;}else{this._maximizeMixin.useAnimation=false;this._maximizeMixin.duration=0;}},_setHelpURLAttr:function(url){var _28=this.helpURL;this.helpURL=url;if(!this._idxStarted){return;}var _29=(_14.nullTrim(_28)?false:true);var _2a=(_14.nullTrim(this.helpURL)?false:true);if(_29==_2a){return;}if(!_2a){this._createDefaultHelpButton();}else{this._destroyDefaultHelpButton();}},_createDefaultCloseButton:function(){if(this._closeButton){return;}this._closeButton=new _12({buttonType:"close",placement:"toolbar",region:"titleActions",displayMode:this.defaultActionDisplay});if(this._closeHandle){this._closeHandle.remove();delete this._closeHandle;}this._closeHandle=_8.after(this._closeButton,"onClick",_2.hitch(this,"_closePane"),true);this.addChild(this._closeButton);if(this._idxStarted){this._closeButton.startup();}},_destroyDefaultCloseButton:function(){if(this._closeHandle){this._closeHandle.remove();delete this._closeHandle;}if(this._closeButton){this.removeChild(this._closeButton);this._closeButton.destroyRecursive();delete this._closeButton;}},_createDefaultRefreshButton:function(){if(this._refreshButton){return;}this._refreshButton=new _12({buttonType:"refresh",placement:"toolbar",region:"titleActions",displayMode:this.defaultActionDisplay});if(this._refreshHandle){this._refreshHandle.remove();delete this._refreshHandle;}this._refreshHandle=_8.after(this._refreshButton,"onClick",_2.hitch(this,"refreshPane"),true);this.addChild(this._refreshButton);if(this._idxStarted){this._refreshButton.startup();}},_destroyDefaultRefreshButton:function(){if(this._refreshHandle){this._refreshHandle.remove();delete this._refreshHandle;}if(this._refreshButton){this.removeChild(this._refreshButton);this._refreshButton.destroyRecursive();delete this._refreshButton;}},_createDefaultResizeButton:function(){if(this._resizeButton){return;}this._resizeButton=new _12({buttonType:"maxRestore",placement:"toolbar",region:"titleActions",displayMode:this.defaultActionDisplay});if(this._resizeHandle){this._resizeHandle.remove();delete this._resizeHandle;}this._resizeHandle=_8.after(this._resizeButton,"onButtonTypeClick",_2.hitch(this,"_resizePane"),true);this.addChild(this._resizeButton);if(this._idxStarted){this._resizeButton.startup();}},_destroyDefaultResizeButton:function(){if(this._resizeHandle){this._resizeHandle.remove();delete this._resizeHandle;}if(this._resizeButton){this.removeChild(this._resizeButton);this._resizeButton.destroyRecursive();delete this._resizeButton;}},_createDefaultHelpButton:function(){if(this._helpButton){return;}this._helpButton=new _12({buttonType:"help",placement:"toolbar",region:"titleActions",displayMode:this.defaultActionDisplay});if(this._helpHandle){this._helpHandle.remove();delete this._helpHandle;}this._helpHandle=_8.after(this._helpButton,"onClick",_2.hitch(this,"_displayHelp"),true);this.addChild(this._helpButton);if(this._idxStarted){this._helpButton.startup();}},_destroyDefaultHelpButton:function(){if(this._helpHandle){this._helpHandle.remove();delete this._helpHandle;}if(this._helpButton){this.removeChild(this._helpButton);this._helpButton.destroyRecursive();delete this._helpButton;}},startup:function(){if(!this._started){this.inherited(arguments);}if(this._idxStarted){return;}this._idxStarted=true;if(this._href){this.set("href",this._href);}if(this._isShown()||this.preload){this._onShow();}_6.forEach(this.getChildren(),this._setupChild,this);if(this.refreshable){this._createDefaultRefreshButton();}if(_14.nullTrim(this.helpURL)){this._createDefaultHelpButton();}if(this.resizable){this._createDefaultResizeButton();}if(this.closable){this._createDefaultCloseButton();}this.resize();},_removeDefaultButtons:function(_2b){if(this._restoringDefaultButtons){return false;}var _2c=false;if(this._closeButton){if(_2b!=this._closeButton){this.removeChild(this._closeButton);_2c=true;}}if(this._resizeButton){if(_2b!=this._resizeButton){this.removeChild(this._resizeButton);_2c=true;}}if(this._helpButton){if(_2b!=this._helpButton){this.removeChild(this._helpButton);_2c=true;}}if(this._refreshButton){if(_2b!=this._refreshButton){this.removeChild(this._refreshButton);_2c=true;}}return _2c;},_restoreDefaultButtons:function(){if(this._restoringDefaultButtons){return;}this._restoringDefaultButtons=true;if(this._refreshButton){this.addChild(this._refreshButton);}if(this._helpButton){this.addChild(this._helpButton);}if(this._resizeButton){this.addChild(this._resizeButton);}if(this._closeButton){this.addChild(this._closeButton);}this._restoringDefaultButtons=false;},addChild:function(_2d,_2e){var _2f=this._removeDefaultButtons(_2d);if((!this._isDefaultButton(_2d))||(!_2f)){this.inherited(arguments);}if(_2f){this._restoreDefaultButtons(_2d);}this.resize();},_isDefaultButton:function(_30){return ((_30==this._closeButton)||(_30==this._resizeButton)||(_30==this._refreshButton)||(_30==this._helpButton));},removeChild:function(_31){var _32=0;var _33=-1;var _34=null;for(_32=0;_32<this._titleActions.length;_32++){if(_31===this._titleActions[_32].widget){_33=_32;_34=this._titleActions;var _35=this._titleActions[_32].handle;if(_35){_35.remove();delete this._titleActions[_32].handle;}break;}}if(_33>=0){_34.splice(_33,1);}this.inherited(arguments);if((_31)&&(_31==this._enhancedTitle)){this._internalSet=true;this.set("title","");this._internalSet=false;}this.resize();},_setupChild:function(_36){this.inherited(arguments);var _37=_14.nullTrim(_36.get("region"));if(_37=="title"){this.set("title",_36);return;}var _38=null;if((_37==null)||(_37.length==0)){_37="body";}var _39=this._regionLookup[_37];var _38=this._actionsLookup[_37];if(_39==null){_39=this._regionLookup["body"];_38=null;}if(_39==this.containerNode){return;}var _3a=new _16(_36.domNode);_3a.orphan();_a.place(_36.domNode,_39,"last");var _3b=null;if(_36.onResize){_3b=_8.after(_36,"onResize",_2.hitch(this,"resize"),true);}_38.push({widget:_36,handle:_3b});},getTitleActionChildren:function(){var _3c=[];for(var _3d=0;_3d<this._titleActions.length;_3d++){var _3e=this._titleActions[_3d];_3c.push(_3e.widget);}return _3c;},layout:function(){this._checkIfSingleChild();this.inherited(arguments);},_checkIfSingleChild:function(){this.inherited(arguments);},resize:function(_3f,_40){if(!this._idxStarted){return;}this.inherited(arguments);_c.set(this.titleNode,{width:"auto",height:"auto"});_c.set(this._titleActionsNode,{width:"auto",height:"auto"});var _41=_13.getStaticSize(this.titleNode);var _42=_13.getStaticSize(this._titleActionsNode);var _43=((_41.h>_42.h)?_41.h:_42.h);_c.set(this.titleNode,{width:"auto",height:"auto"});_c.set(this._titleActionsNode,{width:"auto",height:"auto"});_c.set(this.focusNode,{height:_43+"px"});if(this.open&&this._singleChild&&this._singleChild.resize){var cb=_e.getContentBox(this.containerNode);this._singleChild.resize({w:cb.w});_b.add(this._singleChild.domNode,this.baseClass+"-onlyChild");}},_onShow:function(){if(!this._idxStarted){return;}this.inherited(arguments);},_setHrefAttr:function(_44){if(!this._idxStarted){this._href=_44;return;}else{this._href=null;}if(this.href==_44){return;}this.inherited(arguments);},set:function(_45,_46){if((!this._internalSet)&&(_45=="title")){this._setTitleObject(_46);}else{this.inherited(arguments);}},get:function(_47){if((!this._internalGet)&&(_47=="title")&&(this._enhancedTitle)){return this._enhancedTitle;}else{return this.inherited(arguments);}},_setTitleObject:function(_48){if(this._enhancedTitle){this.removeChild(this._enhancedTitle);if(this._enhancedTitle.destroyRecursive){this._enhancedTitle.destroy();}else{if(this._enhancedTitle.destroy){this._enhancedTitle.destroyRecursive();}}}this.titleNode.innerHTML="";if(_13.typeOfObject(_48)!="object"){this._internalSet=true;this.set("title",""+_48);this._internalSet=false;this._enhancedTitle=null;return;}this._enhancedTitle=_48;var _49=null;if(_48 instanceof _11){_49=_48.domNode;}else{_49=_48;}var _4a=new _16(_49);_4a.orphan();_a.place(_49,this.titleNode,"last");this.resize();},_closePane:function(e){if(e){_9.stop(e);}this.onClose();this.destroyRecursive();},onRefresh:function(_4b,_4c,_4d){},refreshPane:function(e){if(e){_9.stop(e);}var _4e=this.get("href");if(!_14.nullTrim(_4e)){this.onRefresh(this);return;}var _4f=_e.getContentBox(this.containerNode);_c.set(this.containerNode,{height:""+_4f.h+"px"});this._refreshing=true;var _50=this.refresh();this.onRefresh(this,_4e,_50);},onDownloadEnd:function(){this.inherited(arguments);this._refreshing=false;_c.set(this.containerNode,{height:null});this.resize();},onDownloadError:function(){this.inherited(arguments);this._refreshing=false;_c.set(this.containerNode,{height:null});this.resize();},_resizePane:function(e,_51){if(e){_9.stop(e);}switch(_51){case "maximize":this.maximizePane();break;case "restore":this.restorePane();break;}return false;},maximizePane:function(_52){if(!_52){_52=this.domNode.parentNode;}if(!_52){return;}var _53=this.domNode.style.position;this._restorePosition=(_14.nullTrim(_53)?_53:"");this._restoreCollapse=this.get("collapsible");this.set("collapsible",false);switch(_53){case "absolute":break;default:_c.set(this.domNode,{position:"relative"});}var _54=_e.getMarginBox(this.titleBarNode);this._maximizeMixin.maximize(this.domNode,_52);this._maximized=true;_c.set(this.hideNode,{position:"absolute",top:""+_54.h+"px",left:"0px",right:"0px",bottom:"0px"});_b.remove(this.titleBarNode,"dijitTitlePaneTitleHover");if(this._resizeButton){this._resizeButton.set("hovering",false);this._resizeButton.set("active",false);}this.onMaximize();},restorePane:function(){if(!this._maximized){return;}this._maximizeMixin.restore();},_onRestore:function(){_c.set(this.hideNode,{position:"",top:"",left:"",right:"",bottom:""});_c.set(this.domNode,{position:this._restorePosition});this.set("collapsible",this._restoreCollapse);this._maximized=false;_b.remove(this.titleBarNode,"dijitTitlePaneTitleHover");if(this._resizeButton){this._resizeButton.set("hovering",false);this._resizeButton.set("active",false);}this.onRestore();},onMaximize:function(){},onRestore:function(){},_displayHelp:function(e){if(e){_9.stop(e);}if(_14.nullTrim(this.helpURL)){if((!this._helpWindow)||(this._helpWindow.closed)){this._openNewHelpWindow();}else{try{this._helpWindow.location.assign(this.helpURL);this._helpWindow.focus();}catch(err){this._openNewHelpWindow();}}}},_openNewHelpWindow:function(){if(!_14.nullTrim(this.helpURL)){return;}this._helpWindow=window.open(this.helpURL,"_blank");if((this.helpURL.indexOf("http://")==0)||(this.helpURL.indexOf("https://")==0)){this._helpWindow=null;}}});});