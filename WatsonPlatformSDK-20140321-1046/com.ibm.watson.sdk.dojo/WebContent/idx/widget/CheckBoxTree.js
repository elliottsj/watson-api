//>>built
define("idx/widget/CheckBoxTree",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dijit/Tree","dijit/_WidgetsInTemplateMixin","idx/form/TriStateCheckBox","./checkboxtree/_dndSelector","./_CheckBoxTreeNode"],function(_1,_2,_3,_4,_5,_6,_7,_8){var _9=_3.getObject("idx.oneui",true);return _9.CheckBoxTree=_1("idx.widget.CheckBoxTree",[_4],{baseClass:"idxCheckBoxTree",dndController:_7,openOnClick:false,_itemStatus:null,postMixInProperties:function(){this.inherited(arguments);this._itemStatus={};},_createTreeNode:function(_a){return new _8(_a);},toggleNode:function(_b,_c){if(_3.isString(_b)){var _d=this.getNodesByItem(_b);_b=_d&&_d[0]?_d[0]:undefined;}if(_b){if(_c==undefined){_c=!_b.checkboxNode.get("checked");}if(_2.indexOf(_b.checkboxNode.states,_c)>=0){_b.updateState(_c);}}},_onNodeStateChange:function(_e,_f){this.onNodeStateChange(_e,_f);},onNodeStateChange:function(_10,_11){},_onEnterKey:function(_12){this._publish("execute",{item:_12.item,node:_12.node});this.dndController.userSelect(_12.node,true,false);this.onClick(_12.item,_12.node,_12.evt);},_onItemChildrenChange:function(_13,_14){var _15=this.model,_16=_15.getIdentity(_13),_17=this._itemNodesMap[_16];if(_17){_2.forEach(_17,function(_18){_18.setChildItems(_14);_18.update();_18.updateParent();});}},_expandNode:function(_19,_1a){if(_19._expandNodeDeferred&&!_1a){return _19._expandNodeDeferred;}var _1b=this.model,_1c=_19.item,_1d=this;switch(_19.state){case "UNCHECKED":_19.markProcessing();var def=(_19._expandNodeDeferred=new dojo.Deferred());var _1e=_19.checkboxNode.get("checked");_1b.getChildren(_1c,function(_1f){_19.unmarkProcessing();var _20=_19.setChildItems(_1f);_20.addCallback(function(){_19.updateState(_1e);});var ed=_1d._expandNode(_19,true);_20.addCallback(function(){ed.addCallback(function(){def.callback();});});},function(err){});break;default:def=(_19._expandNodeDeferred=_19.expand());this.onOpen(_19.item,_19);this._state(_19,true);}return def;},_onEnterKey:function(_21){_21.node.checkboxNode.click();var _22=_21.node.checkboxNode.get("checked");_21.node.updateState(_22);},getSelectedItems:function(){var _23=[];for(var id in this._itemStatus){if(this._itemStatus[id]===true){_23.push(id);}}return _23;}});});